<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#1a1a2e">
  <title>My Apps</title>
  <link rel="manifest" href="/manifest.json">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #1a1a2e;
      color: #eee;
      min-height: 100vh;
      padding-bottom: 100px;
    }
    .header {
      position: sticky;
      top: 0;
      background: #16213e;
      padding: 16px;
      border-bottom: 1px solid #0f3460;
      z-index: 100;
    }
    .header h1 {
      font-size: 20px;
      margin-bottom: 12px;
      color: #e94560;
    }
    .search {
      width: 100%;
      padding: 14px 16px;
      font-size: 16px;
      border: 2px solid #0f3460;
      border-radius: 12px;
      background: #1a1a2e;
      color: #eee;
      outline: none;
    }
    .search:focus {
      border-color: #e94560;
    }
    .search::placeholder {
      color: #666;
    }
    .tabs {
      display: flex;
      gap: 8px;
      margin-top: 12px;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
    .tab {
      padding: 8px 16px;
      background: #0f3460;
      border: none;
      border-radius: 20px;
      color: #aaa;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      cursor: pointer;
    }
    .tab.active {
      background: #e94560;
      color: white;
    }
    .content {
      padding: 16px;
    }
    .category {
      margin-bottom: 24px;
    }
    .category-title {
      font-size: 14px;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
      padding-left: 4px;
    }
    .app-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .app-card {
      background: #16213e;
      border-radius: 12px;
      padding: 14px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    .app-info {
      flex: 1;
      min-width: 0;
    }
    .app-name {
      font-weight: 600;
      font-size: 16px;
      color: #eee;
      margin-bottom: 2px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .app-url {
      font-size: 12px;
      color: #666;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .app-actions {
      display: flex;
      gap: 8px;
      flex-shrink: 0;
    }
    .btn {
      padding: 10px 14px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.1s, opacity 0.2s;
    }
    .btn:active {
      transform: scale(0.95);
    }
    .btn-copy {
      background: #0f3460;
      color: #aaa;
    }
    .btn-copy.copied {
      background: #27ae60;
      color: white;
    }
    .btn-sms {
      background: #e94560;
      color: white;
    }
    .btn-open {
      background: #0f3460;
      color: #4fc3f7;
      text-decoration: none;
      display: flex;
      align-items: center;
    }
    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      background: #27ae60;
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 600;
      opacity: 0;
      transition: opacity 0.3s;
      z-index: 200;
    }
    .toast.show {
      opacity: 1;
    }
    .footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #16213e;
      border-top: 1px solid #0f3460;
      padding: 16px;
      display: flex;
      gap: 12px;
    }
    .footer-btn {
      flex: 1;
      padding: 14px;
      border: none;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
    }
    .footer-btn.primary {
      background: #e94560;
      color: white;
    }
    .footer-btn.secondary {
      background: #0f3460;
      color: #aaa;
    }
    .empty {
      text-align: center;
      padding: 40px 20px;
      color: #666;
    }
    .count {
      font-size: 12px;
      color: #666;
      padding: 8px 16px;
    }
  </style>
</head>
<body>
  <div class="header">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
      <h1>ðŸš€ My Apps</h1>
      <button onclick="showHelp()" style="background:none;border:none;color:#888;font-size:13px;cursor:pointer;">How to update â“˜</button>
    </div>
    <input type="search" class="search" id="search" placeholder="Search all apps..." autocomplete="off">
    <div class="tabs" id="tabs"></div>
  </div>

  <!-- Help Modal -->
  <div id="helpModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.8);z-index:300;padding:20px;overflow-y:auto;">
    <div style="max-width:400px;margin:40px auto;background:#16213e;border-radius:16px;padding:24px;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
        <h2 style="color:#e94560;font-size:18px;">How to Update</h2>
        <button onclick="hideHelp()" style="background:none;border:none;color:#888;font-size:24px;cursor:pointer;">Ã—</button>
      </div>

      <div style="color:#ccc;font-size:14px;line-height:1.6;">
        <p style="margin-bottom:16px;"><strong style="color:#e94560;">Adding Code63 apps?</strong><br>
        They auto-sync daily. Or trigger manually at:<br>
        <a href="https://github.com/mrpoffice-collab/app-hub/actions" target="_blank" style="color:#4fc3f7;">GitHub Actions â†’ Run workflow</a></p>

        <p style="margin-bottom:16px;"><strong style="color:#e94560;">Adding standalone apps?</strong><br>
        1. Edit <code style="background:#0f3460;padding:2px 6px;border-radius:4px;">MY_APPS</code> in index.html<br>
        2. Double-click <code style="background:#0f3460;padding:2px 6px;border-radius:4px;">update.bat</code></p>

        <p style="margin-bottom:16px;"><strong style="color:#e94560;">Files location:</strong><br>
        <code style="background:#0f3460;padding:2px 6px;border-radius:4px;font-size:12px;">C:\Users\mrpof\APPS Homemade\app-hub\</code></p>

        <p><strong style="color:#e94560;">Quick update command:</strong></p>
        <code style="display:block;background:#0f3460;padding:10px;border-radius:6px;font-size:11px;margin-top:8px;word-break:break-all;">cd app-hub && node build.js && git add -A && git commit -m "Update" && git push</code>
      </div>

      <button onclick="hideHelp()" style="width:100%;margin-top:20px;padding:14px;background:#e94560;color:white;border:none;border-radius:10px;font-weight:600;font-size:16px;cursor:pointer;">Got it</button>
    </div>
  </div>

  <div class="count" id="count"></div>
  <div class="content" id="content"></div>

  <div class="toast" id="toast">Link copied!</div>

  <div class="footer">
    <button class="footer-btn secondary" onclick="location.reload()">Refresh</button>
    <button class="footer-btn primary" onclick="addToHome()">Add to Home</button>
  </div>

  <script>
    // ============================================
    // APP REGISTRY - Add your apps here!
    // ============================================
    const MY_APPS = [
      // ===== MY STANDALONE APPS =====
      { name: "Track My Client (CRM)", url: "https://track-my-client.vercel.app", category: "Business" },
      { name: "Firefly Grove", url: "https://firefly-grove-meschelles-projects.vercel.app", category: "Creative" },
      { name: "Whisper Journals", url: "https://whisper-journals.vercel.app", category: "Personal" },
      { name: "Whispering Art", url: "https://whispering-art.vercel.app", category: "Creative" },
      { name: "Code63 Art", url: "https://www.code63.art", category: "Creative" },
      { name: "AISO Studio", url: "https://aiso.studio", category: "Creative" },
      { name: "Cardulary", url: "https://cardulary.com", category: "Tools" },
      { name: "Spondulic", url: "https://spondulic.vercel.app", category: "Finance" },
      { name: "Code63 Box", url: "https://code63box.vercel.app", category: "Tools" },
      { name: "Chore Race", url: "https://chore-race.vercel.app", category: "Family" },
      { name: "Jotto", url: "https://jotto-xi.vercel.app", category: "Games" },
      { name: "Polite Fury", url: "https://polite-fury.vercel.app", category: "Tools" },
      { name: "Skit Maker", url: "https://skit-maker.vercel.app", category: "Creative" },
      { name: "Rhythm Planner", url: "https://rhythm-planner.vercel.app", category: "Personal" },
      { name: "CCS", url: "https://ccs-five.vercel.app", category: "Tools" },
      { name: "Crawl Simulator", url: "https://crawl-simulator.vercel.app", category: "Tools" },

      // ===== CODE63 PORTALS =====
      { name: "Code63 Apps (600+ tools)", url: "https://www.code63apps.com", category: "Portals" },
      { name: "Code63 Share Hub", url: "https://code63apps.com/share", category: "Portals" },
    ];

    // Code63 individual apps - loaded dynamically
    const CODE63_APPS = REGISTERED_APPS_PLACEHOLDER;

    // Combine all apps
    let allApps = [...MY_APPS];

    // Add Code63 apps with proper URLs
    if (Array.isArray(CODE63_APPS) && CODE63_APPS.length > 0) {
      CODE63_APPS.forEach(slug => {
        allApps.push({
          name: formatName(slug),
          url: `https://code63apps.com/apps/${slug}`,
          category: "Code63"
        });
      });
    }

    function formatName(slug) {
      return slug.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
    }

    // State
    let currentCategory = 'All';
    let searchTerm = '';

    // Get unique categories
    function getCategories() {
      const cats = new Set(allApps.map(a => a.category));
      return ['All', ...Array.from(cats).sort()];
    }

    // Filter apps
    function filterApps() {
      return allApps.filter(app => {
        const matchesSearch = !searchTerm ||
          app.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
          app.url.toLowerCase().includes(searchTerm.toLowerCase());
        const matchesCategory = currentCategory === 'All' || app.category === currentCategory;
        return matchesSearch && matchesCategory;
      });
    }

    // Render tabs
    function renderTabs() {
      const tabs = document.getElementById('tabs');
      tabs.innerHTML = getCategories().map(cat =>
        `<button class="tab ${cat === currentCategory ? 'active' : ''}" onclick="setCategory('${cat}')">${cat}</button>`
      ).join('');
    }

    // Render apps
    function renderApps() {
      const filtered = filterApps();
      const content = document.getElementById('content');
      const count = document.getElementById('count');

      count.textContent = `${filtered.length} app${filtered.length !== 1 ? 's' : ''}`;

      if (filtered.length === 0) {
        content.innerHTML = '<div class="empty">No apps found</div>';
        return;
      }

      // Group by category if showing all
      if (currentCategory === 'All' && !searchTerm) {
        const grouped = {};
        filtered.forEach(app => {
          if (!grouped[app.category]) grouped[app.category] = [];
          grouped[app.category].push(app);
        });

        content.innerHTML = Object.entries(grouped)
          .sort((a, b) => a[0].localeCompare(b[0]))
          .map(([cat, apps]) => `
            <div class="category">
              <div class="category-title">${cat} (${apps.length})</div>
              <div class="app-list">
                ${apps.slice(0, 20).map(renderAppCard).join('')}
                ${apps.length > 20 ? `<div style="color:#666;font-size:13px;padding:8px;">+${apps.length - 20} more - search to find</div>` : ''}
              </div>
            </div>
          `).join('');
      } else {
        content.innerHTML = `
          <div class="app-list">
            ${filtered.slice(0, 50).map(renderAppCard).join('')}
            ${filtered.length > 50 ? `<div style="color:#666;font-size:13px;padding:8px;text-align:center;">Showing 50 of ${filtered.length} - refine search</div>` : ''}
          </div>
        `;
      }
    }

    function renderAppCard(app) {
      const shortUrl = app.url.replace('https://', '').replace('http://', '');
      return `
        <div class="app-card">
          <div class="app-info">
            <div class="app-name">${app.name}</div>
            <div class="app-url">${shortUrl}</div>
          </div>
          <div class="app-actions">
            <button class="btn btn-copy" onclick="copyLink('${app.url}', this)">Copy</button>
            <button class="btn btn-sms" onclick="shareSMS('${app.url}', '${app.name}')">SMS</button>
            <a href="${app.url}" target="_blank" class="btn btn-open">â†—</a>
          </div>
        </div>
      `;
    }

    // Actions
    function setCategory(cat) {
      currentCategory = cat;
      renderTabs();
      renderApps();
    }

    function copyLink(url, btn) {
      navigator.clipboard.writeText(url).then(() => {
        btn.textContent = 'âœ“';
        btn.classList.add('copied');
        showToast('Link copied!');
        setTimeout(() => {
          btn.textContent = 'Copy';
          btn.classList.remove('copied');
        }, 2000);
      });
    }

    function shareSMS(url, name) {
      const msg = `Check out ${name}: ${url}`;
      window.location.href = `sms:?body=${encodeURIComponent(msg)}`;
    }

    function showToast(msg) {
      const toast = document.getElementById('toast');
      toast.textContent = msg;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2000);
    }

    function addToHome() {
      alert('On iPhone: Tap Share â†’ Add to Home Screen\n\nOn Android: Tap Menu â†’ Add to Home Screen');
    }

    function showHelp() {
      document.getElementById('helpModal').style.display = 'block';
    }

    function hideHelp() {
      document.getElementById('helpModal').style.display = 'none';
    }

    // Search handler
    document.getElementById('search').addEventListener('input', (e) => {
      searchTerm = e.target.value;
      renderApps();
    });

    // Init
    renderTabs();
    renderApps();
  </script>
</body>
</html>
